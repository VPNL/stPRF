function [response,StartTime] = waitTill(ReturnTime,StartTime)% [response,StartTime] = WaitTill(ReturnTime,[StartTime])%% Waits and listens to keyboard presses.%%Inputs:%%  time:       WaitTill waits 'time' seconds after StartTime before%              returning.%%  StartTime:  Number of seconds since the system started up.%              If not given, WaitTill gets a new StartTime.%%Outputs:%  %  key         last key pressed during waiting period.%%Example:%%StartTime = getSecs;%ReturnTime = 5; %seconds%key = WaitTill(ReturnTime,StartTime);%disp(['key ',key,' was the last key pressed during the ',num2str(ReturnTime),' second interval.']);%%SEE ALSO:  getSecs%5/31/97 gmb Wrote it.%1/10/98 gmb Revised it for verstion 5if nargin < 1	disp('*** Error:  WaitTill needs at least one argument.');	returnendif (nargin == 1)	StartTime = GetSecs;end%fprintf ('ReturnTime=%d',ReturnTime);response.keyCode = [];response.secs = [];if ReturnTime < (GetSecs-StartTime)    [keyIsDown,secs,keyCode] = KbCheck;    %[keyIsDown,secs,keyCode] = KbCheck;    if(keyIsDown)        response.keyCode = keyCode;        response.secs = secs;    end	%if CharAvail, key = GetChar; end	disp('Warning!  WaitTill: ReturnTime passed before waiting begins.');	returnendwhile(GetSecs < StartTime+ReturnTime)    [keyIsDown,secs,keyCode] = KbCheck;    if(keyIsDown)        response.keyCode = keyCode;        response.secs = secs;    end	%if CharAvail, key = GetChar; end    WaitSecs(0.003); % Give other processes a few milliseconds of CPU timeendreturn;